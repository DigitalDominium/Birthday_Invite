<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>You're Invited! | The Sims-style Birthday Unlock</title>
<meta name="description" content="Complete your Sim's needs to unlock the birthday venue!" />
<meta property="og:title" content="You're Invited! üéâ" />
<meta property="og:description" content="Do the mini-activities to reveal the party location." />
<meta name="theme-color" content="#28e06f" />

<style>
  :root{
    --bg:#0b1522;            /* deep blue background */
    --panel:#132233;         /* card bg */
    --text:#dfe8f3;          /* main text */
    --muted:#9bb0c6;         /* secondary text */
    --accent:#28e06f;        /* Sims plumbob green */
    --accent-2:#20b857;      /* darker green */
    --bar-bg:#1a2c42;        /* need bar bg */
    --bar-fill:#28e06f;      /* need bar fill */
    --warning:#ffcc00;
    --danger:#ff5c7a;
    --shadow:0 10px 30px rgba(0,0,0,.35);
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    background:
      radial-gradient(1200px 600px at 10% -20%, #1a3a57 0%, transparent 60%),
      radial-gradient(1000px 600px at 90% -10%, #0f2438 0%, transparent 60%),
      var(--bg);
    color:var(--text);
    display:flex;
    align-items:center;
    justify-content:center;
    padding:24px;
  }

  .card{
    width:min(980px, 100%);
    background:linear-gradient(180deg, rgba(255,255,255,.02), transparent 40%),
               var(--panel);
    border:1px solid rgba(255,255,255,.06);
    border-radius:18px;
    box-shadow:var(--shadow);
    overflow:hidden;
  }

  .hero{
    position:relative;
    padding:28px 24px 10px;
    display:grid;
    grid-template-columns: 160px 1fr;
    gap:16px;
  }

  /* Plumbob (pure CSS) */
  .plumbob-wrap{
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .plumbob{
    width:0;height:0;
    border-left:28px solid transparent;
    border-right:28px solid transparent;
    border-bottom:60px solid var(--accent);
    filter:drop-shadow(0 6px 10px rgba(40,224,111,.35));
    position:relative;
    animation:bob 2.6s ease-in-out infinite;
  }
  .plumbob::after{
    content:"";
    position:absolute; left:-28px; top:60px;
    width:0;height:0;
    border-left:28px solid transparent;
    border-right:28px solid transparent;
    border-top:48px solid var(--accent-2);
  }
  @keyframes bob{
    0%,100%{ transform:translateY(-6px) rotate(0.0001deg) }
    50%{ transform:translateY(6px) rotate(0.0001deg) }
  }

  .title h1{
    margin:0 0 6px;
    font-size:clamp(22px, 4vw, 36px);
    letter-spacing:.3px;
  }
  .title p{ margin:0; color:var(--muted) }

  .grid{
    display:grid;
    grid-template-columns: 320px 1fr;
    gap:16px;
    padding:12px 24px 24px;
  }
  @media (max-width: 860px){
    .hero{ grid-template-columns: 1fr; text-align:center }
    .grid{ grid-template-columns: 1fr }
    .plumbob-wrap{ order:-1; margin-bottom:6px }
  }

  /* Sim panel */
  .sim-panel{
    background:rgba(255,255,255,.02);
    border:1px solid rgba(255,255,255,.06);
    border-radius:14px;
    padding:16px;
  }
  .sim-stage{
    background:linear-gradient(180deg, #0e2031 0%, #0b1624 100%);
    border:1px solid rgba(255,255,255,.05);
    border-radius:12px;
    height:280px;
    position:relative;
    overflow:hidden;
  }
  .sim{
    position:absolute; inset:0;
    display:flex; align-items:center; justify-content:center; gap:18px;
  }
  .avatar{
    width:120px; height:160px; position:relative;
    filter:drop-shadow(0 10px 12px rgba(0,0,0,.45));
  }
  .head{
    width:80px; height:80px; background:#ffddb9; border-radius:50%;
    margin:0 auto; position:relative; top:4px;
  }
  .body{
    width:120px; height:90px; background:#2b6cb0; border-radius:60px 60px 16px 16px;
    margin:0 auto; position:relative; top:10px;
  }
  .plumbob-mini{
    position:absolute; top:-18px; left:50%; transform:translateX(-50%);
    width:0;height:0; border-left:10px solid transparent; border-right:10px solid transparent; border-bottom:22px solid var(--accent);
  }
  .plumbob-mini::after{
    content:""; position:absolute; left:-10px; top:22px;
    width:0;height:0; border-left:10px solid transparent; border-right:10px solid transparent; border-top:16px solid var(--accent-2);
  }

  /* Interactives */
  .props{
    display:flex; gap:12px; flex-wrap:wrap; justify-content:center;
    position:absolute; bottom:10px; left:0; right:0;
  }
  .prop{
    user-select:none; cursor:grab;
    background:#17283d; border:1px solid rgba(255,255,255,.06);
    padding:10px 12px; border-radius:12px; font-size:20px;
    display:flex; align-items:center; gap:8px;
    transition:transform .1s ease;
  }
  .prop:active{ cursor:grabbing; transform:scale(.98) }
  .prop[data-type="cake"]::after{ content:" Cake" }
  .prop[data-type="note"]::after{ content:" Dance" }
  .prop[data-type="pillow"]::after{ content:" Nap" }

  .drop-zone{
    position:absolute; inset:0; outline:2px dashed transparent; border-radius:12px;
    transition:.2s ease;
  }
  .drop-zone.ready{ outline-color: rgba(40,224,111,.35) }

  /* Needs */
  .needs{
    background:rgba(255,255,255,.02);
    border:1px solid rgba(255,255,255,.06);
    border-radius:14px;
    padding:16px;
    display:grid; gap:12px;
    height:100%;
  }
  .need{
    display:grid; grid-template-columns: 130px 1fr auto; gap:10px; align-items:center;
  }
  .need .label{ color:var(--muted); font-size:14px; text-transform:uppercase; letter-spacing:.8px }
  .bar{
    background:var(--bar-bg); height:14px; border-radius:999px; overflow:hidden; position:relative;
  }
  .bar .fill{
    width:0%; height:100%; background:linear-gradient(90deg, var(--bar-fill), #5cff9a);
    transition:width .3s ease;
  }
  .need .pct{ width:42px; text-align:right; font-variant-numeric: tabular-nums }
  .need.done .label{ color:var(--accent) }
  .need.done .pct{ color:var(--accent) }
  .hint{ color:var(--muted); font-size:12px; margin-top:4px }

  /* Invite Reveal */
  .reveal{
    background:
      radial-gradient(600px 140px at 50% 0%, rgba(40,224,111,.08), transparent 60%),
      rgba(255,255,255,.02);
    border-top:1px solid rgba(255,255,255,.06);
    padding:18px 24px 26px;
    text-align:center;
  }
  .lock-msg{
    color:var(--warning);
    display:flex; gap:8px; align-items:center; justify-content:center;
    font-size:14px;
  }
  .invite{
    display:none;
    margin-top:6px;
  }
  .invite h2{ margin:12px 0 8px; font-size:28px }
  .invite .meta{
    display:grid; gap:6px; justify-content:center; margin:6px 0 12px; color:var(--muted)
  }
  .pill{
    display:inline-block; padding:10px 14px; border-radius:999px;
    background:linear-gradient(180deg, #2a3e2f, #1d2b22);
    border:1px solid rgba(40,224,111,.35);
    color:#c9ffd8;
  }
  .btn{
    appearance:none; border:0; cursor:pointer;
    padding:12px 18px; border-radius:12px; font-weight:600;
    background:linear-gradient(180deg, #28e06f, #1dc261);
    color:#06230f; box-shadow:0 8px 18px rgba(40,224,111,.35);
  }
  .btn:active{ transform:translateY(1px) }

  /* Toast */
  .toast{
    position:fixed; left:50%; bottom:18px; transform:translateX(-50%);
    background:#0e1a28; color:var(--text);
    border:1px solid rgba(255,255,255,.08);
    padding:10px 14px; border-radius:999px; box-shadow:var(--shadow);
    display:none; font-size:14px;
  }

  /* Confetti canvas */
  canvas#confetti{ position:fixed; inset:0; pointer-events:none }
</style>
</head>
<body>
<canvas id="confetti"></canvas>

<div class="card" role="main" aria-labelledby="title">
  <div class="hero">
    <div class="plumbob-wrap" aria-hidden="true">
      <div class="plumbob" title="Plumbob"></div>
    </div>
    <div class="title">
      <h1 id="title">Complete your Sim‚Äôs needs to unlock the invite üéÇ</h1>
      <p>Drag <span aria-hidden="true">üç∞</span> cake onto your Sim, tap the <span aria-hidden="true">üéµ</span> music to dance, and press-and-hold the <span aria-hidden="true">üõèÔ∏è</span> pillow to nap.</p>
    </div>
  </div>

  <div class="grid">
    <!-- Left: Sim + interactions -->
    <section class="sim-panel" aria-label="Play area">
      <div class="sim-stage" id="stage">
        <div class="drop-zone" id="dropZone" aria-hidden="true"></div>
        <div class="sim">
          <div class="avatar" aria-label="Your Sim">
            <div class="plumbob-mini" aria-hidden="true"></div>
            <div class="head" aria-hidden="true"></div>
            <div class="body" aria-hidden="true"></div>
          </div>
        </div>

        <div class="props" aria-label="Activities">
          <div class="prop" draggable="true" data-type="cake" aria-grabbed="false" role="button" aria-label="Drag cake to feed (Hunger)">
            üç∞
          </div>
          <button class="prop" data-type="note" id="danceBtn" aria-label="Tap to dance (Fun)" type="button">üéµ</button>
          <button class="prop" data-type="pillow" id="napBtn" aria-label="Press and hold to nap (Energy)" type="button">üõèÔ∏è</button>
        </div>
      </div>
      <p class="hint">Tip: drag the cake into the play area, tap the music 10√ó to dance, hold the pillow for 3 seconds to nap.</p>
    </section>

    <!-- Right: Needs bars -->
    <aside class="needs" aria-label="Needs">
      <div class="need" data-need="hunger">
        <div class="label">Hunger</div>
        <div class="bar"><div class="fill" id="bar-hunger"></div></div>
        <div class="pct" id="pct-hunger">0%</div>
      </div>
      <div class="need" data-need="fun">
        <div class="label">Fun</div>
        <div class="bar"><div class="fill" id="bar-fun"></div></div>
        <div class="pct" id="pct-fun">0%</div>
      </div>
      <div class="need" data-need="energy">
        <div class="label">Energy</div>
        <div class="bar"><div class="fill" id="bar-energy"></div></div>
        <div class="pct" id="pct-energy">0%</div>
      </div>
    </aside>
  </div>

  <div class="reveal" id="reveal">
    <div class="lock-msg" id="lockMsg">üîí Fill all needs to reveal the party location.</div>

    <div class="invite" id="invite">
      <h2>üéâ You‚Äôre Invited, <span id="cfgName">Friend</span>!</h2>
      <div class="meta">
        <div><span class="pill" id="cfgDate">Sat, 18 Oct ¬∑ 6:00 PM</span></div>
        <div><span class="pill" id="cfgVenue">Green Rooftop Garden, Orchard</span></div>
      </div>
      <a class="btn" id="cfgRSVP" href="#" target="_blank" rel="noopener">RSVP Now</a>
      <p class="hint" style="margin-top:10px">Share this page or print it‚Äîplumbob approved ‚úÖ</p>
    </div>
  </div>
</div>

<div class="toast" id="toast" role="status" aria-live="polite">Nice! Keep going‚Ä¶</div>

<script>
/* ============================
   üîß CONFIG ‚Äî edit these
   ============================ */
const INVITE_CONFIG = {
  guestName: "David‚Äôs Guest",
  dateTime: "Sat, 18 Oct 2025 ¬∑ 6:00 PM",
  venue: "Level 5 Sky Garden, 313@Somerset",
  rsvpUrl: "https://example.com/rsvp",
  needsRequired: { hunger: 100, fun: 100, energy: 100 },
  danceClicksNeeded: 10,
  napHoldMs: 3000
};

/* Apply config text */
document.getElementById("cfgName").textContent = INVITE_CONFIG.guestName;
document.getElementById("cfgDate").textContent = INVITE_CONFIG.dateTime;
document.getElementById("cfgVenue").textContent = INVITE_CONFIG.venue;
document.getElementById("cfgRSVP").href = INVITE_CONFIG.rsvpUrl;

/* ============================
   State
   ============================ */
const state = {
  hunger: 0,
  fun: 0,
  energy: 0,
  danceClicks: 0,
  napping: false,
  napStart: 0
};

const bars = {
  hunger: document.getElementById("bar-hunger"),
  fun: document.getElementById("bar-fun"),
  energy: document.getElementById("bar-energy")
};
const pcts = {
  hunger: document.getElementById("pct-hunger"),
  fun: document.getElementById("pct-fun"),
  energy: document.getElementById("pct-energy")
};

function clamp(v){ return Math.max(0, Math.min(100, Math.round(v))) }
function updateNeed(name, value){
  state[name] = clamp(value);
  bars[name].style.width = state[name] + "%";
  pcts[name].textContent = state[name] + "%";
  const needEl = document.querySelector(`.need[data-need="${name}"]`);
  needEl.classList.toggle("done", state[name] >= INVITE_CONFIG.needsRequired[name]);
  checkUnlock();
}

function toast(msg){
  const t = document.getElementById("toast");
  t.textContent = msg; t.style.display = "block";
  clearTimeout(toast._id);
  toast._id = setTimeout(()=> t.style.display = "none", 1400);
}

/* ============================
   Activity 1: Feed cake (drag ‚Üí drop)
   ============================ */
const stage = document.getElementById("stage");
const dropZone = document.getElementById("dropZone");
const cake = document.querySelector('.prop[data-type="cake"]');

cake.addEventListener("dragstart", e=>{
  cake.setAttribute("aria-grabbed", "true");
  dropZone.classList.add("ready");
  e.dataTransfer.setData("text/plain", "cake");
});
cake.addEventListener("dragend", ()=>{
  cake.setAttribute("aria-grabbed", "false");
  dropZone.classList.remove("ready");
});

dropZone.addEventListener("dragover", e=> e.preventDefault());
dropZone.addEventListener("drop", e=>{
  e.preventDefault();
  const type = e.dataTransfer.getData("text/plain");
  if(type === "cake"){
    updateNeed("hunger", state.hunger + 35);
    toast("Mmm‚Ä¶ cake! (+35 Hunger)");
  }
});

/* ============================
   Activity 2: Dance (tap button N times)
   ============================ */
const danceBtn = document.getElementById("danceBtn");
danceBtn.addEventListener("click", ()=>{
  state.danceClicks++;
  const inc = 100 / INVITE_CONFIG.danceClicksNeeded;
  updateNeed("fun", state.fun + inc);
  danceBtn.animate([{ transform:"scale(1)" },{ transform:"scale(1.08)" },{ transform:"scale(1)" }], { duration:200 });
  toast("üéµ Bust a move! (+Fun)");
});

/* ============================
   Activity 3: Nap (press & hold for X ms)
   ============================ */
const napBtn = document.getElementById("napBtn");
let holdTimer = null, tickTimer = null;

napBtn.addEventListener("pointerdown", ()=>{
  if(state.napping) return;
  state.napping = true;
  state.napStart = performance.now();
  napBtn.classList.add("holding");
  // Visual pulse
  tickTimer = setInterval(()=>{
    const elapsed = performance.now() - state.napStart;
    const pct = Math.min(1, elapsed / INVITE_CONFIG.napHoldMs);
    // show small incremental energy while holding
    updateNeed("energy", Math.max(state.energy, pct * 100));
  }, 100);
});

["pointerup","pointerleave","pointercancel"].forEach(ev=>{
  napBtn.addEventListener(ev, ()=>{
    if(!state.napping) return;
    state.napping = false;
    napBtn.classList.remove("holding");
    clearInterval(tickTimer);
    const held = performance.now() - state.napStart;
    if(held >= INVITE_CONFIG.napHoldMs){
      updateNeed("energy", 100);
      toast("üí§ Power nap complete! (+Energy)");
    } else {
      toast("Hold a bit longer to finish your nap!");
    }
  }, { passive:true });
});

/* ============================
   Unlock + Reveal
   ============================ */
function allGreen(){
  return ["hunger","fun","energy"].every(k => state[k] >= INVITE_CONFIG.needsRequired[k]);
}

function checkUnlock(){
  if(allGreen()){
    document.getElementById("lockMsg").style.display = "none";
    const invite = document.getElementById("invite");
    if(invite.style.display !== "block"){
      invite.style.display = "block";
      confettiBurst();
    }
  }
}

/* ============================
   Minimal Confetti
   ============================ */
const c = document.getElementById("confetti");
const ctx = c.getContext("2d");
let confettiPieces = [];
function resizeCanvas(){ c.width = innerWidth; c.height = innerHeight }
addEventListener("resize", resizeCanvas, { passive:true }); resizeCanvas();

function confettiBurst(){
  confettiPieces = [];
  const colors = ["#28e06f","#5cff9a","#ffffff","#9be6c3"];
  for(let i=0;i<160;i++){
    confettiPieces.push({
      x: Math.random()*c.width,
      y: -10,
      w: 6 + Math.random()*6,
      h: 10 + Math.random()*16,
      color: colors[Math.floor(Math.random()*colors.length)],
      vx: (Math.random()-0.5)*2,
      vy: 2 + Math.random()*3,
      rot: Math.random()*Math.PI,
      vr: (Math.random()-0.5)*0.1
    });
  }
  animateConfetti();
  setTimeout(()=> confettiPieces = [], 3000);
}
function animateConfetti(){
  if(confettiPieces.length===0) return;
  ctx.clearRect(0,0,c.width,c.height);
  confettiPieces.forEach(p=>{
    p.x += p.vx; p.y += p.vy; p.rot += p.vr;
    ctx.save();
    ctx.translate(p.x,p.y);
    ctx.rotate(p.rot);
    ctx.fillStyle = p.color;
    ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);
    ctx.restore();
  });
  requestAnimationFrame(animateConfetti);
}

/* ============================
   Keyboard accessibility
   ============================ */
cake.addEventListener("keydown",(e)=>{
  if(e.key==="Enter"||e.key===" "){ updateNeed("hunger", state.hunger + 35); toast("Mmm‚Ä¶ cake! (+35 Hunger)"); }
});

/* Optional: small idle fun drain to feel alive */
setInterval(()=>{
  if(!allGreen()){
    updateNeed("fun", state.fun - 1);
  }
}, 5000);
</script>
</body>
</html>
