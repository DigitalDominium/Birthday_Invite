<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Birthday Invite ‚Äî Sims‚ÄëStyle Click Game</title>
  <style>
    :root {
      --wall:#eaf5ff;
      --floor:#d8bfa0;
      --shadow:rgba(0,0,0,.15);
      --accent:#7c3aed; /* purple */
      --success:#22c55e; /* green */
      --danger:#ef4444; /* red */
      --ink:#1f2937;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink)}
    body{display:flex;align-items:center;justify-content:center;background:#f7fafc}

    .room{
      width:min(980px,95vw);height:min(620px,90vh);position:relative;border-radius:18px;overflow:hidden;box-shadow:0 20px 40px var(--shadow),0 2px 0 white inset;background:linear-gradient(180deg,var(--wall) 0 65%, var(--floor) 65% 100%);
    }
    .room::after{ /* floor seam */
      content:"";position:absolute;left:0;right:0;top:65%;height:6px;background:linear-gradient(90deg, #0000 0 15%, rgba(0,0,0,.05) 15% 16%, #0000 16% 100%);
    }

    .hud{
      position:absolute;inset:14px 14px auto 14px;display:flex;gap:8px;align-items:center;justify-content:space-between;pointer-events:none
    }
    .pill{pointer-events:auto;background:white;border-radius:999px;padding:10px 14px;box-shadow:0 4px 12px var(--shadow);display:flex;align-items:center;gap:10px}
    .pill small{opacity:.7}
    .seq{display:flex;gap:8px}
    .chip{width:34px;height:34px;border-radius:10px;display:grid;place-items:center;background:#f1f5f9;font-size:20px;box-shadow:inset 0 -2px 0 rgba(0,0,0,.06)}
    .chip.done{background:#dcfce7}
    .chip.error{background:#fee2e2}

    .grid{position:absolute;inset:20% 6% 8% 6%;display:grid;grid-template-columns:repeat(6,1fr);grid-template-rows:repeat(3,1fr);gap:2%}

    /* Furniture */
    .sofa{grid-column:2/6;grid-row:3/4;background:#7dd3fc;border-radius:20px/24px 24px 14px 14px;position:relative;box-shadow:0 12px 0 rgba(0,0,0,.08) inset}
    .sofa::after{content:"";position:absolute;left:6%;right:6%;top:-12px;height:26px;background:#bae6fd;border-radius:16px;box-shadow:0 3px 0 rgba(0,0,0,.05)}

    .table{grid-column:3/5;grid-row:2/3;background:#fff;border-radius:14px;box-shadow:0 10px 24px var(--shadow);position:relative}
    .table::after{content:"";position:absolute;inset:0;border-radius:14px;box-shadow:inset 0 -4px 0 rgba(0,0,0,.06)}

    .side{grid-column:6/7;grid-row:2/3;border-radius:14px;background:#fff;box-shadow:0 8px 18px var(--shadow);position:relative;display:grid;place-items:center}

    .plant{grid-column:1/2;grid-row:2/3;display:grid;place-items:center}

    button.obj{border:0;background:transparent;cursor:pointer;position:relative;transition:transform .12s ease;filter:drop-shadow(0 6px 10px var(--shadow))}
    button.obj:active{transform:scale(.98)}
    .label{position:absolute;left:50%;top:100%;transform:translate(-50%,8px);padding:6px 10px;border-radius:999px;background:#111827;color:white;font-size:12px;box-shadow:0 6px 14px var(--shadow)}

    /* SVG Sizes */
    .cake{width:min(120px,18vmin)}
    .gift{width:min(110px,16vmin)}
    .balloons{width:min(130px,18vmin)}
    .plant svg{width:min(110px,16vmin)}

    /* Invite modal */
    .modal{position:absolute;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;padding:20px}
    .card{width:min(680px,96vw);background:white;border-radius:20px;box-shadow:0 30px 60px rgba(0,0,0,.25);padding:28px 24px;animation:pop .28s ease forwards}
    @keyframes pop{from{transform:translateY(8px);opacity:0}to{transform:translateY(0);opacity:1}}
    .title{font-size:28px;margin:0 0 8px}
    .subtitle{margin:0 0 16px;opacity:.75}
    .details{display:grid;grid-template-columns:28px 1fr;gap:10px 14px;align-items:start;margin:10px 0 14px}
    .badge{display:inline-flex;gap:8px;align-items:center;background:#f1f5f9;padding:8px 12px;border-radius:999px;margin-right:8px}
    .cta{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .btn{border:0;border-radius:12px;padding:12px 16px;font-weight:600;cursor:pointer}
    .btn.primary{background:var(--accent);color:white}
    .btn.ghost{background:#eef2ff;color:#3730a3}

    /* Toast */
    .toast{position:absolute;left:50%;bottom:14px;transform:translateX(-50%);background:#111827;color:white;padding:10px 14px;border-radius:12px;display:none;box-shadow:0 8px 18px var(--shadow)}

    /* Confetti Canvas */
    canvas#confetti{position:absolute;inset:0;pointer-events:none}

    /* Responsive tweaks */
    @media (max-width:560px){
      .grid{inset:22% 4% 8%}
      .label{display:none}
    }
  </style>
</head>
<body>
  <div class="room" id="room">
    <canvas id="confetti"></canvas>

    <!-- HUD / Sequence Tracker -->
    <div class="hud">
      <div class="pill" aria-live="polite">
        <strong>Goal:</strong> <small>Click in order ‚Üí</small>
        <div class="seq" id="seq">
          <div class="chip" data-step="0" title="Cake">üéÇ</div>
          <div class="chip" data-step="1" title="Gift">üéÅ</div>
          <div class="chip" data-step="2" title="Balloons">üéà</div>
        </div>
      </div>
      <div class="pill" style="gap:12px">
        <button id="reset" class="btn ghost" title="Reset order">Reset</button>
        <span style="opacity:.6">Sims‚Äëstyle invite</span>
      </div>
    </div>

    <!-- Scene Grid -->
    <div class="grid">
      <div class="plant">
        <!-- simple plant -->
        <svg viewBox="0 0 120 160" aria-hidden="true">
          <ellipse cx="60" cy="120" rx="40" ry="16" fill="#b45309"/>
          <rect x="30" y="80" width="60" height="40" rx="8" fill="#f59e0b"/>
          <path d="M60 80 C40 60, 40 40, 60 30 C80 40, 80 60, 60 80" fill="#10b981"/>
          <path d="M60 80 C30 70, 30 50, 48 38" fill="#34d399"/>
          <path d="M60 80 C90 70, 90 50, 72 38" fill="#34d399"/>
        </svg>
      </div>

      <div class="table" style="display:grid;place-items:center">
        <!-- CAKE (Step 1) -->
        <button class="obj" id="cake" aria-label="Cake">
          <svg class="cake" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
            <rect x="30" y="120" width="140" height="46" rx="14" fill="#fde68a"/>
            <rect x="38" y="115" width="124" height="16" rx="8" fill="#f59e0b"/>
            <rect x="40" y="88" width="120" height="40" rx="12" fill="#fecdd3"/>
            <path d="M40 108 Q60 96 70 108 T100 108 T130 108 T160 108 V128 H40 Z" fill="#fb7185"/>
            <g>
              <rect x="60" y="60" width="10" height="28" rx="5" fill="#fde68a"/>
              <rect x="95" y="56" width="10" height="32" rx="5" fill="#fde68a"/>
              <rect x="130" y="62" width="10" height="26" rx="5" fill="#fde68a"/>
              <path d="M65 56 q5 -12 10 0" stroke="#f59e0b" stroke-width="3" fill="none"/>
              <path d="M100 52 q5 -12 10 0" stroke="#f59e0b" stroke-width="3" fill="none"/>
              <path d="M135 58 q5 -12 10 0" stroke="#f59e0b" stroke-width="3" fill="none"/>
            </g>
          </svg>
          <span class="label">Cake</span>
        </button>
      </div>

      <div class="sofa"></div>

      <div class="side">
        <!-- GIFT (Step 2) -->
        <button class="obj" id="gift" aria-label="Gift">
          <svg class="gift" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
            <rect x="40" y="80" width="120" height="80" rx="12" fill="#c7d2fe"/>
            <rect x="40" y="80" width="120" height="16" fill="#818cf8"/>
            <rect x="90" y="80" width="20" height="80" fill="#6366f1"/>
            <path d="M100 80 C70 70, 70 40, 85 40 C100 42, 100 62, 100 62" stroke="#6366f1" stroke-width="10" fill="none"/>
            <path d="M100 80 C130 70, 130 40, 115 40 C100 42, 100 62, 100 62" stroke="#6366f1" stroke-width="10" fill="none"/>
          </svg>
          <span class="label">Gift</span>
        </button>
      </div>

      <div style="grid-column:4/6;grid-row:1/2;display:grid;place-items:center">
        <!-- BALLOONS (Step 3) -->
        <button class="obj" id="balloons" aria-label="Balloons">
          <svg class="balloons" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
            <ellipse cx="70" cy="80" rx="34" ry="40" fill="#fca5a5"/>
            <ellipse cx="110" cy="70" rx="34" ry="40" fill="#a7f3d0"/>
            <ellipse cx="140" cy="88" rx="34" ry="40" fill="#93c5fd"/>
            <path d="M70 120 C70 140, 62 156, 56 172" stroke="#9ca3af" stroke-width="2" fill="none"/>
            <path d="M110 110 C110 138, 100 160, 92 176" stroke="#9ca3af" stroke-width="2" fill="none"/>
            <path d="M140 128 C140 150, 132 166, 126 178" stroke="#9ca3af" stroke-width="2" fill="none"/>
          </svg>
          <span class="label">Balloons</span>
        </button>
      </div>
    </div>

    <!-- Modal invite -->
    <div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="title">
      <div class="card">
        <h2 class="title" id="title">David‚Äôs Birthday Bash üéâ</h2>
        <p class="subtitle">You cracked the sequence: <strong>Cake ‚Üí Gift ‚Üí Balloons</strong>!</p>
        <div class="badge">üìç <span><strong>Venue:</strong> Pingnakorn Nimman Hotel, Chiang Mai</span></div>
        <div class="badge">üìÖ <span><strong>Date:</strong> Sat, 26 Oct 2025</span></div>
        <div class="badge">üïñ <span><strong>Time:</strong> 7:00 PM</span></div>

        <div class="details">
          <div>‚ÑπÔ∏è</div>
          <div>Dress code: Smart‚Äëcasual with a splash of purple. Bring your best vibes. Food, games, and cake guaranteed!</div>
          <div>‚úÖ</div>
          <div>Please RSVP by 12 Oct via WhatsApp.</div>
        </div>

        <div class="cta">
          <a id="addCal" class="btn primary" href="#">Add to Calendar</a>
          <button class="btn ghost" id="close">Close</button>
        </div>
      </div>
    </div>

    <div class="toast" id="toast">Wrong order ‚Äî try Cake ‚Üí Gift ‚Üí Balloons</div>
  </div>

  <script>
    // --- Sequence Logic ---
    const order = ["cake","gift","balloons"]; // change here to customize order
    let progress = 0;

    const chips = [...document.querySelectorAll('.chip')];
    const toast = document.getElementById('toast');
    const modal = document.getElementById('modal');
    const resetBtn = document.getElementById('reset');
    const closeBtn = document.getElementById('close');

    function markChips(){
      chips.forEach((c,i)=>{
        c.classList.toggle('done', i < progress);
        c.classList.remove('error');
      })
    }
    function wrong(){
      chips.forEach(c=>c.classList.add('error'));
      toast.style.display='block';
      clearTimeout(wrong.t);
      wrong.t=setTimeout(()=>toast.style.display='none',1400);
      shake(document.getElementById('room'));
      progress=0;markChips();
    }
    function shake(el){
      el.animate([{transform:'translateX(0)'},{transform:'translateX(-6px)'},{transform:'translateX(6px)'},{transform:'translateX(0)'}],{duration:220});
    }

    function tryStep(id){
      if(id===order[progress]){
        progress++;markChips();
        pulse(document.getElementById(id));
        if(progress===order.length){ celebrate(); }
      }else wrong();
    }
    function pulse(btn){
      btn.animate([{transform:'scale(1)'},{transform:'scale(1.06)'},{transform:'scale(1)'}],{duration:220});
    }

    ["cake","gift","balloons"].forEach(id=>{
      document.getElementById(id).addEventListener('click',()=>tryStep(id));
    });

    resetBtn.addEventListener('click',()=>{progress=0;markChips();});
    closeBtn.addEventListener('click',()=>{modal.style.display='none'});

    // --- Confetti + Success ---
    const canvas = document.getElementById('confetti');
    const ctx = canvas.getContext('2d');
    const DPR = Math.max(1, window.devicePixelRatio || 1);
    function resize(){
      canvas.width = canvas.clientWidth * DPR;
      canvas.height = canvas.clientHeight * DPR;
    }
    window.addEventListener('resize', resize); resize();

    let confetti = [];
    function celebrate(){
      for(let i=0;i<140;i++) confetti.push(makePiece());
      modal.style.display='flex';
      addCalendarLink();
      tick();
    }
    function makePiece(){
      return {x:Math.random()*canvas.width,y:-10*Math.random()*canvas.height,vx:(Math.random()-.5)*2,vy:2+Math.random()*2,s:4+Math.random()*6,r:Math.random()*Math.PI,dr:(Math.random()-.5)*.2,c:["#f43f5e","#10b981","#3b82f6","#f59e0b","#8b5cf6"][Math.floor(Math.random()*5)]};
    }
    function tick(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      confetti.forEach(p=>{
        p.x+=p.vx; p.y+=p.vy; p.r+=p.dr;
        ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.r); ctx.fillStyle=p.c; ctx.fillRect(-p.s/2,-p.s/2,p.s,p.s); ctx.restore();
      });
      confetti = confetti.filter(p=>p.y<canvas.height+20);
      if(confetti.length) requestAnimationFrame(tick);
    }

    // --- Add to Calendar (ICS) ---
    function addCalendarLink(){
      const a = document.getElementById('addCal');
      const title = encodeURIComponent("David‚Äôs Birthday Bash üéâ");
      // Adjust date/time here (local assumed +08:00 ‚Üí convert to UTC for ICS if needed)
      const start = new Date('2025-10-26T19:00:00+08:00');
      const end = new Date('2025-10-26T22:00:00+08:00');
      function toICS(dt){
        // YYYYMMDDTHHMMSSZ
        return dt.toISOString().replace(/[-:]/g,'').replace(/\.\d{3}Z$/,'Z');
      }
      const ics = `BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//SimsInvite//EN\nBEGIN:VEVENT\nUID:${Date.now()}@simsinvite\nDTSTAMP:${toICS(new Date())}\nDTSTART:${toICS(start)}\nDTEND:${toICS(end)}\nSUMMARY:${title}\nLOCATION:${encodeURIComponent('Pingnakorn Nimman Hotel, Chiang Mai')}\nDESCRIPTION:${encodeURIComponent('Dress code: Smart‚Äëcasual with purple accent. RSVP by 12 Oct.')}\nEND:VEVENT\nEND:VCALENDAR`;
      const blob = new Blob([ics], {type:'text/calendar'});
      a.href = URL.createObjectURL(blob);
      a.download = 'Birthday-Invite.ics';
    }

    // --- Optional: URL params to customize quickly ---
    // Example: ?name=Alex&date=2025-12-01&time=18:30&venue=Rooftop
    const params = new URLSearchParams(location.search);
    if(params.size){
      const name = params.get('name') || 'Friend';
      const date = params.get('date');
      const time = params.get('time');
      const venue = params.get('venue');
      if(name) document.querySelector('#title').textContent = `${name}‚Äôs Birthday Bash üéâ`;
      if(venue){
        document.querySelectorAll('.badge')[0].innerHTML = `üìç <span><strong>Venue:</strong> ${venue}</span>`;
      }
      if(date){
        document.querySelectorAll('.badge')[1].innerHTML = `üìÖ <span><strong>Date:</strong> ${new Date(date).toDateString()}</span>`;
      }
      if(time){
        document.querySelectorAll('.badge')[2].innerHTML = `üïñ <span><strong>Time:</strong> ${time}</span>`;
      }
    }
  </script>
</body>
</html>
